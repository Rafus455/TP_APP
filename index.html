<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centre M√©t√©o</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <div class="container">
        <!-- En-t√™te avec logo -->
        <header class="header">
            <div class="logo-container">
                <div class="logo">‚òÄÔ∏è</div>
                <h1 class="logo-text">Centre M√©t√©o</h1>
            </div>
        </header>

        <!-- Zone de recherche -->
        <div class="search-container">
            <input type="text" class="ville-input" id="ville" placeholder="Rechercher une ville...">
            <button id="recherche">üîç Rechercher</button>
        </div>

        <!-- Messages de chargement et erreur -->
        <p id="loading" class="hidden">‚è≥ Chargement...</p>
        <p id="error-message" class="hidden"></p>

        <!-- Section m√©t√©o principale -->
        <div id="weather-section" class="hidden">
            <h2 id="city-name">--</h2>
            
            <div class="temp-container">
                <div id="weather-icon"></div>
                <div class="temperature">
                    <span id="temperature">--</span>¬∞C
                </div>
            </div>

            <div class="weather-details">
                <div class="detail-item">
                    <div class="detail-icon">üí®</div>
                    <div class="detail-label">Vent</div>
                    <div class="detail-value" id="wind">--</div>
                </div>
                <div class="detail-item">
                    <div class="detail-icon">üíß</div>
                    <div class="detail-label">Humidit√©</div>
                    <div class="detail-value" id="humidity">--</div>
                </div>
                <div class="detail-item">
                    <div class="detail-icon">üå°Ô∏è</div>
                    <div class="detail-label">Ressenti</div>
                    <div class="detail-value" id="feels-like">--</div>
                </div>
            </div>

            <!-- Pr√©visions horaires -->
            <div id="hourly-list"></div>
            
            <!-- Bouton notifications -->
            <button id="notify-btn">
                üîî Activer les notifications
            </button>
        </div>
    </div>

    <!-- Script pour le background dynamique -->
    <script>
        const ACCESS_KEY = "4y-7VAiONHJruREqc7S7M39RGl83Vn4Mn3ilObGPcg0";

        async function updateBackground(ville) {
            if (!ville) return;
            
            const defaultImage = "https://images.unsplash.com/photo-1592210454359-9043f067919b?auto=format&fit=crop&w=1600";

            try {
                const res = await fetch(`https://api.unsplash.com/photos/random?query=nature,${ville}&orientation=landscape&client_id=${ACCESS_KEY}`);
                
                if (res.ok) {
                    const data = await res.json();
                    if (data && data.urls && data.urls.full) {
                        applyBackground(data.urls.full);
                    } else {
                        applyBackground(defaultImage);
                    }
                } else {
                    console.warn("Erreur Unsplash, image par d√©faut.");
                    applyBackground(defaultImage);
                }
            } catch (err) {
                console.log("Erreur JS background:", err);
                applyBackground(defaultImage);
            }
        }

        function applyBackground(url) {
            document.body.style.setProperty('--bg-image', `url(${url})`);
            document.body.classList.add('has-background');
        }

        const inputVille = document.getElementById("ville");
        const btnRecherche = document.getElementById("recherche");

        btnRecherche.addEventListener("click", function() {
            const villeNom = inputVille.value.trim();
            if (villeNom) {
                updateBackground(villeNom);
            }
        });

        inputVille.addEventListener("keydown", function (event) {
            if (event.key === "Enter") {
                event.preventDefault();
                btnRecherche.click();
                inputVille.blur();
            }
        });
    </script>

    <!-- Script logique m√©t√©o -->
    <script src="app.js"></script>
</body>
</html>